#!/bin/bash
# Run Claude Code with super agent settings (auto-approve mode)
#
# Injects superagents.md content via --append-system-prompt so the agent
# knows it's running in autonomous mode with auto-approve permissions.

SUPER_INSTRUCTIONS="/workspace/.boxctl/superagents.md"

# Build the append prompt from superagents.md if it exists
APPEND_PROMPT=""
if [[ -f "${SUPER_INSTRUCTIONS}" ]]; then
    APPEND_PROMPT=$(cat "${SUPER_INSTRUCTIONS}")
fi

# Export env var so MCP can also detect super mode
export BOXCTL_SUPER_MODE=true

exec claude \
    --dangerously-skip-permissions \
    --settings /home/abox/.claude/settings-super.json \
    --mcp-config /home/abox/.mcp.json \
    --append-system-prompt "${APPEND_PROMPT}" \
    "$@"
